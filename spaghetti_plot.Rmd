---
title: "Sphagetti Plot"
author: "Wu Gong"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    self_contained: true
    thumbnails: false
    code_folding: hide
    toc_depth: 6
    lightbox: true
    gallery: false
    highlight: monochrome
    css: Wu.css
---


	
```{r setup, echo=FALSE, cache=FALSE,warning=FALSE,message=FALSE}
library(knitr)
library(rmdformats)
library(Wu)
opts_chunk$set(echo=TRUE
             , cache=FALSE
             , eval=TRUE
             , prompt=FALSE
             , results="asis"
             , tidy=FALSE
             , comment=NA
             , message=FALSE
             , warning=FALSE
             , out.width = '80%'
             , class.source='klippy'
               )
eval_fast <- TRUE
eval_slow <- FALSE
klippy::klippy(position = c('top', 'left')
             , tooltip_message = 'Click to copy'
             , tooltip_success = 'Done')
```




# [Back to Index](index.html)


# Sphaghetti Plot with ggplot2


```{r}
library(Wu)
library(data.table)

dt <- data.table(
    id = 1:6
  , num = c(3, 5, 6, 3, 4, 5)
  , m = c(1.1, 1.2, 1.3, 1.2, 1.4, 1.3)
)

rnorm_vec <- function(x){
    rnorm(n = 1, mean = x)
}
rnorm_vec <- Vectorize(rnorm_vec)


dt2 <- dt[rep(1:.N, times = num)]
dt2 <- dt2[, value := rnorm_vec(m)
           ][, times := 1:.N, by = .(id)]



nudge_x <- -0.2

ggplot(data = dt2
     , aes(x = times
         , y = value
         ## , type = type
         ## , id = redcap_id
         , group = id
         , color = factor(id)
           )) +
    geom_line(
        alpha = 0.3
      , size = 1.2
      ## , color = "#333333"
        ## , color = factor(record_id)
    ) +
    geom_point(
        shape = 19
      , size = 3
      ## , color = "#333333"
        ## , color = factor(record_id)
      ## , stroke = sqrt(dr2$size)/2
      , alpha = 0.5
    ) +
    geom_text(aes(label = id), nudge_x =  nudge_x)+ 
    xlab("Times") +
    scale_x_continuous(breaks = c(1, 2, 3, 4, 5, 6), labels = c(1, 2, 3, 4, 5, 6)) +
    ylab("Value") +
    ## scale_fill_manual(values = Colors) +
    ## scale_y_log10() +
    ## annotation_logticks() +
    ## coord_cartesian(xlim = c(-90, 900)) +
    theme(legend.position = "none", axis.ticks = element_blank()) -> p
p


dt2 %>% prt()

```


# R sessionInfo

```{r}
sessionInfo()

```
